---
title: "linearGR_Models"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache = TRUE)

library(lme4)
library(caret)
library(tidyverse)
```

```{r load data}

load(file = paste0('D:/projects/linkedModels/data/out/dG_bktbntats1997_forLmer.RData')) # made by running mainAnalysis_Nimble.R with speciesGr = c("bkt", "bnt","ats") through ddG[[ii]] <- dddG[[ii]] %>% prepareDataForJags("growth")

d2 <- data.frame(
  #sampleNumber=ddG[[1]][[2]]$sampleNumber,
  
  ind=ddG[[1]][[1]]$ind,
  river=ddG[[1]][[1]]$riverDATA,
  season=ddG[[1]][[1]]$season,
  year=ddG[[1]][[1]]$year,
  species=ddG[[1]][[1]]$species,
  sampleNumber=ddG[[1]][[1]]$sampleNumber,
  isYOY=ddG[[1]][[1]]$isYOYDATA,
  length=ddG[[1]][[1]]$lengthDATAStd,
  lengthByYear=ddG[[1]][[1]]$lengthDATAStd_ByYOY_Year,
  grLength=ddG[[1]][[1]]$grNotUse,
  tempStd=ddG[[1]][[1]]$tempStd,
  flowStd=ddG[[1]][[1]]$flowStd,
  countPStd=ddG[[1]][[1]]$countPAllSppStd,

  countPStdBKT=ddG[[1]][[1]]$countPStdBKT,
  countPStdBNT=ddG[[1]][[1]]$countPStdBNT,
  countPStdATS=ddG[[1]][[1]]$countPStdATS,
  
  countPBKT=ddG[[1]][[1]]$cBKTStd,
  countPBNT=ddG[[1]][[1]]$cBNTStd,
  countPATS=ddG[[1]][[1]]$cATSStd,
  
  ATS01DATA=ddG[[1]][[1]]$ATS01DATA
  )

d <- d2 %>% filter( !is.na(grLength) )

d <- d %>% filter(
 !is.na(countPStd) #removes 5 obs
  )

d <- d %>% mutate( tempStd2 = tempStd^2, 
                   flowStd2 = flowStd^2, 
                   countPStd2 = countPStd^2, 
                   length2 = length^2, lengthByYear2 = lengthByYear^2,
                   countPStdBKT2 = countPStdBKT^2,
                   countPStdBNT2 = countPStdBNT^2,
                   countPStdATS2 = countPStdATS^2,
                   isYOY = as.factor(isYOY), season = as.factor(season), 
                   river = as.factor(river), species = as.factor(species)
                   
                 )
d$grLength <- ifelse(d$species == 2 & d$river == 3, NA, d$grLength)
d$grLength <- ifelse(d$species %in% c('2','3') & d$isYOY == 1 & d$season == "2", NA, d$grLength)
d$grLength <- ifelse(d$grLength < -0.025, NA, d$grLength)

d <- d %>%
  mutate(
    cBKTStd = as.numeric(scale(countPBKT)),
    cBNTStd = as.numeric(scale(countPBNT)),
    cATSStd = as.numeric(scale(countPATS)),
    cBKTStd2 = cBKTStd^2,
    cBNTStd2 = cBNTStd^2,
    cATSStd2 = cATSStd^2
  )

#turn off very low densities of ATS in jimmy 
#d$cATSStd <- ifelse(d$river %in% c('2') , NA, d$cATSStd)
#d$cATSStd2 <- ifelse(d$river %in% c('2') , NA, d$cATSStd2)

mod <- list()

bySpecies <- d %>% 
  filter( species %in% c(1,2,3) ) %>%
  group_by(species) %>% 
  nest()

# turn factor off for ATS so the models run for all three spp
bySpecies$data[[3]]$river <- as.numeric(bySpecies$data[[3]]$river)


```

```{r}
# -2.5 values are mostly from season==2 and isYOY==1
# ggplot(d, aes(sampleNumber,cBKTStd)) + geom_point() + geom_line() + facet_grid(season~river)
# ggplot(d, aes(sampleNumber,cBNTStd)) + geom_point() + geom_line() + facet_grid(season~river)
# ggplot(d, aes(sampleNumber,cATSStd)) + geom_point() + geom_line() + facet_grid(season~river)
# 
# ggplot(d, aes(sampleNumber,cATSStd)) + geom_point() + geom_line() + facet_wrap(~river)

```

```{r}

# ggplot(d, aes(sampleNumber,grLength)) + geom_point()  + facet_grid(species~river+season)
# 
# ggplot(d, aes(cBKTStd,grLength)) + geom_point()  + facet_grid(species~river+season)
# ggplot(d, aes(cBNTStd,grLength)) + geom_point()  + facet_grid(species~river+season)
# ggplot(d, aes(cATSStd,grLength)) + geom_point()  + facet_grid(species~river+season)

```

```{r}
# pairs(d[,c('countPStd','countPStdBKT_01','countPStdBNT_01','countPStdATS_01')])
# pairs(d[,c('countPBKT','countPBNT','countPATS')])
# pairs(d[,c('cBKTStd','cBNTStd','cATSStd','tempStd','flowStd')])
# pairs(d[,c('tempStd2','flowStd2','tempStd','flowStd')])
# d20 <- d
# d20[d20 == -2.5] <- NA
# pairs(d20[,c('countPStd','countPStdBKT','countPStdBNT','countPStdATS')])
# round(cor(d20[,c('countPStd','countPStdBKT','countPStdBNT','countPStdATS')], use="complete.obs"),2)
```


Try new, more flexible model structure

```{r}

# need length? NO
mod[[1]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   (1|ind) + (1|season), data = df ) }

mod[[2]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd + 
                   lengthByYear  +
                   (1|ind) + (1|season), data = df ) } 
```

        rowname  df       AIC     rowname.1 df.1     AIC.1     rowname.2 df.2     AIC.2
1 o$model1[[1]] 131 -24064.23 o$model1[[2]]   59 -11091.02 o$model1[[3]]   31 -26673.04
2 o$model2[[1]] 132 -24049.02 o$model2[[2]]   60 -11074.95 o$model2[[3]]   32 -26662.86
```{r}

# need squared term for flow or temp?
mod[[3]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * tempStd2 + 
                   isYOY * river * season * flowStd2  +
                   (1|ind) + (1|season), data = df ) } 

mod[[4]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * tempStd2 * flowStd2  +
                   (1|ind) + (1|season), data = df ) } 

mod[[5]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * tempStd2 + 
                   (1|ind) + (1|season), data = df ) } 

mod[[6]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * flowStd2  +
                   (1|ind) + (1|season), data = df ) } 
# keep out squared terms for now
```

        rowname  df       AIC     rowname.1 df.1     AIC.1     rowname.2 df.2     AIC.2
1 o$model1[[1]] 131 -24064.23 o$model1[[2]]   59 -11091.02 o$model3[[3]]   45 -27221.73
2 o$model2[[1]] 132 -24049.02 o$model6[[2]]   73 -11085.12 o$model4[[3]]   52 -27214.79
3 o$model5[[1]] 163 -23950.60 o$model2[[2]]   60 -11074.95 o$model6[[3]]   38 -26849.65
4 o$model6[[1]] 163 -23862.94 o$model5[[2]]   73 -11045.37 o$model5[[3]]   38 -26825.20
5 o$model4[[1]] 226 -23856.48 o$model3[[2]]   87 -11011.79 o$model1[[3]]   31 -26673.04
6 o$model3[[1]] 195 -23825.07 o$model4[[2]]  101 -10916.61 o$model2[[3]]   32 -26662.86
```{r}
# add species densities?

mod[[7]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd   +
                   isYOY * season * cBKTStd +
                   (1|ind) + (1|season), data = df ) }

mod[[8]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd   +
                   isYOY * season * cBNTStd +
                   (1|ind) + (1|season), data = df ) }

mod[[9]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd   +
                   isYOY *         season * cATSStd +
                   (1|ind) + (1|season), data = df ) }

mod[[10]] <- function(df) {
 lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                  isYOY * river * season * cBKTStd +
                  isYOY * river * season * cBNTStd +
                  isYOY *         season * cATSStd +
                  (1|ind) + (1|season), data = df ) }

mod[[11]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * season * cBKTStd * cBNTStd * cATSStd +
                   (1|ind) + (1|season), data = df ) }

mod[[12]] <- function(df) {
  print(c('mod = 12' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * season * cBKTStd * cBNTStd +
                   (1|ind) + (1|season), data = df ) } 

# stick with 10 - good for bkt and easiest to code in jags
```

          rowname  df       AIC      rowname.1 df.1     AIC.1      rowname.2 df.2     AIC.2
1  o$model10[[1]] 195 -24650.05 o$model12[[2]]   80 -11203.21 o$model11[[3]]   80 -29379.29
2   o$model7[[1]] 139 -24336.63  o$model8[[2]]   66 -11166.73 o$model10[[3]]   52 -28077.66
3  o$model12[[1]] 155 -24316.48  o$model7[[2]]   66 -11129.29 o$model12[[3]]   52 -27717.41
4  o$model11[[1]] 187 -24259.03 o$model10[[2]]   94 -11119.43  o$model7[[3]]   38 -27339.65
5   o$model1[[1]] 131 -24064.23  o$model9[[2]]   66 -11108.18  o$model3[[3]]   45 -27221.73
6   o$model2[[1]] 132 -24049.02  o$model1[[2]]   59 -11091.02  o$model4[[3]]   52 -27214.79
7   o$model8[[1]] 139 -24045.93  o$model6[[2]]   73 -11085.12  o$model6[[3]]   38 -26849.65
8   o$model9[[1]] 139 -24007.57  o$model2[[2]]   60 -11074.95  o$model8[[3]]   38 -26845.97
9   o$model5[[1]] 163 -23950.60 o$model11[[2]]  108 -11049.99  o$model5[[3]]   38 -26825.20
10  o$model6[[1]] 163 -23862.94  o$model5[[2]]   73 -11045.37  o$model9[[3]]   38 -26695.14
11  o$model4[[1]] 226 -23856.48  o$model3[[2]]   87 -11011.79  o$model1[[3]]   31 -26673.04
12  o$model3[[1]] 195 -23825.07  o$model4[[2]]  101 -10916.61  o$model2[[3]]   32 -26662.86

```{r}

# squared density terms?

mod[[13]] <- function(df) {
    print(c('mod = 13' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cBKTStd2 +
                   
                   (1|ind) + (1|season), data = df ) }

mod[[14]] <- function(df) {
    print(c('mod = 14' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cBNTStd2 +

                   (1|ind) + (1|season), data = df ) }

mod[[15]] <- function(df) {
    print(c('mod = 15' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cATSStd2 +
                   (1|ind) + (1|season), data = df ) }

mod[[16]] <- function(df) {
    print(c('mod = 16' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cBKTStd2 +
                   isYOY * river * season * cBNTStd2 +
                   (1|ind) + (1|season), data = df ) }
```
Keep model16
          rowname  df       AIC      rowname.1 df.1     AIC.1      rowname.2 df.2     AIC.2
1  o$model16[[1]] 249 -24778.30 o$model16[[2]]  122 -11211.56 o$model11[[3]]   80 -29379.29
2  o$model14[[1]] 218 -24767.67 o$model12[[2]]   80 -11203.21 o$model15[[3]]   59 -28755.46
3  o$model13[[1]] 226 -24689.16 o$model13[[2]]  108 -11167.05 o$model16[[3]]   66 -28318.31
4  o$model10[[1]] 195 -24650.05  o$model8[[2]]   66 -11166.73 o$model14[[3]]   59 -28310.73
5  o$model15[[1]] 210 -24589.74 o$model14[[2]]  108 -11140.80 o$model13[[3]]   59 -28306.10
6   o$model7[[1]] 139 -24336.63  o$model7[[2]]   66 -11129.29 o$model10[[3]]   52 -28077.66
7  o$model12[[1]] 155 -24316.48 o$model10[[2]]   94 -11119.43 o$model12[[3]]   52 -27717.41
8  o$model11[[1]] 187 -24259.03  o$model9[[2]]   66 -11108.18  o$model7[[3]]   38 -27339.65
9   o$model1[[1]] 131 -24064.23  o$model1[[2]]   59 -11091.02  o$model3[[3]]   45 -27221.73
10  o$model2[[1]] 132 -24049.02  o$model6[[2]]   73 -11085.12  o$model4[[3]]   52 -27214.79
11  o$model8[[1]] 139 -24045.93  o$model2[[2]]   60 -11074.95  o$model6[[3]]   38 -26849.65
12  o$model9[[1]] 139 -24007.57 o$model11[[2]]  108 -11049.99  o$model8[[3]]   38 -26845.97
13  o$model5[[1]] 163 -23950.60  o$model5[[2]]   73 -11045.37  o$model5[[3]]   38 -26825.20
14  o$model6[[1]] 163 -23862.94 o$model15[[2]]  108 -11030.68  o$model9[[3]]   38 -26695.14
15  o$model4[[1]] 226 -23856.48  o$model3[[2]]   87 -11011.79  o$model1[[3]]   31 -26673.04
16  o$model3[[1]] 195 -23825.07  o$model4[[2]]  101 -10916.61  o$model2[[3]]   32 -26662.86

```{r}

#add interaction btw bkt and bnt?
mod[[17]] <- function(df) {
    print(c('mod = 17' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cBKTStd2 +
                   isYOY * river * season * cBNTStd2 +
                   isYOY * river * season * cBNTStd * cBKTStd +
                   (1|ind) + (1|season), data = df ) }
```
Keep 17
          rowname  df       AIC      rowname.1 df.1     AIC.1      rowname.2 df.2     AIC.2
1  o$model17[[1]] 272 -24796.58 o$model16[[2]]  122 -11211.56 o$model11[[3]]   80 -29379.29
2  o$model16[[1]] 249 -24778.30 o$model17[[2]]  136 -11207.54 o$model15[[3]]   59 -28755.46
3  o$model14[[1]] 218 -24767.67 o$model12[[2]]   80 -11203.21 o$model16[[3]]   66 -28318.31
4  o$model13[[1]] 226 -24689.16 o$model13[[2]]  108 -11167.05 o$model17[[3]]   73 -28313.67
5  o$model10[[1]] 195 -24650.05  o$model8[[2]]   66 -11166.73 o$model14[[3]]   59 -28310.73
6  o$model15[[1]] 210 -24589.74 o$model14[[2]]  108 -11140.80 o$model13[[3]]   59 -28306.10
7   o$model7[[1]] 139 -24336.63  o$model7[[2]]   66 -11129.29 o$model10[[3]]   52 -28077.66
8  o$model12[[1]] 155 -24316.48 o$model10[[2]]   94 -11119.43 o$model12[[3]]   52 -27717.41
9  o$model11[[1]] 187 -24259.03  o$model9[[2]]   66 -11108.18  o$model7[[3]]   38 -27339.65
10  o$model1[[1]] 131 -24064.23  o$model1[[2]]   59 -11091.02  o$model3[[3]]   45 -27221.73
11  o$model2[[1]] 132 -24049.02  o$model6[[2]]   73 -11085.12  o$model4[[3]]   52 -27214.79
12  o$model8[[1]] 139 -24045.93  o$model2[[2]]   60 -11074.95  o$model6[[3]]   38 -26849.65
13  o$model9[[1]] 139 -24007.57 o$model11[[2]]  108 -11049.99  o$model8[[3]]   38 -26845.97
14  o$model5[[1]] 163 -23950.60  o$model5[[2]]   73 -11045.37  o$model5[[3]]   38 -26825.20
15  o$model6[[1]] 163 -23862.94 o$model15[[2]]  108 -11030.68  o$model9[[3]]   38 -26695.14
16  o$model4[[1]] 226 -23856.48  o$model3[[2]]   87 -11011.79  o$model1[[3]]   31 -26673.04
17  o$model3[[1]] 195 -23825.07  o$model4[[2]]  101 -10916.61  o$model2[[3]]   32 -26662.86

```{r}
# add squared flow and temp back in? 
# models with temp or flow squared don't work if have either bnt2 or bkt2 also in model
# test which one to take out with interaction btw cBNT and cBKT in

mod[[18]] <- function(df) {
    print(c('mod = 18' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                 #  isYOY * river * season * cBKTStd2 +
                   isYOY * river * season * cBNTStd2 +
                   isYOY * river * season * cBNTStd * cBKTStd +
                   (1|ind) + (1|season), data = df ) }

mod[[19]] <- function(df) {
    print(c('mod = 19' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cBKTStd2 +
                 #  isYOY * river * season * cBNTStd2 +
                   isYOY * river * season * cBNTStd * cBKTStd +
                   (1|ind) + (1|season), data = df ) }

mod[[20]] <- function(df) {
    print(c('mod = 20' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                 #  isYOY * river * season * cBKTStd2 +
                  # isYOY * river * season * cBNTStd2 +
                   isYOY * river * season * cBNTStd * cBKTStd +
                   (1|ind) + (1|season), data = df ) }
```
Take out bkt2, for models >20
          rowname  df       AIC      rowname.1 df.1     AIC.1      rowname.2 df.2     AIC.2
1  o$model17[[1]] 272 -24796.58 o$model18[[2]]  122 -11217.98 o$model11[[3]]   80 -29379.29
2  o$model18[[1]] 241 -24795.12 o$model16[[2]]  122 -11211.56 o$model15[[3]]   59 -28755.46
3  o$model16[[1]] 249 -24778.30 o$model17[[2]]  136 -11207.54 o$model16[[3]]   66 -28318.31
4  o$model14[[1]] 218 -24767.67 o$model12[[2]]   80 -11203.21 o$model17[[3]]   73 -28313.67
5  o$model19[[1]] 249 -24730.67 o$model20[[2]]  108 -11169.43 o$model14[[3]]   59 -28310.73
6  o$model20[[1]] 218 -24727.16 o$model13[[2]]  108 -11167.05 o$model13[[3]]   59 -28306.10
7  o$model13[[1]] 226 -24689.16  o$model8[[2]]   66 -11166.73 o$model19[[3]]   66 -28282.69
8  o$model10[[1]] 195 -24650.05 o$model19[[2]]  122 -11146.57 o$model18[[3]]   66 -28267.13
9  o$model15[[1]] 210 -24589.74 o$model14[[2]]  108 -11140.80 o$model10[[3]]   52 -28077.66
10  o$model7[[1]] 139 -24336.63  o$model7[[2]]   66 -11129.29 o$model20[[3]]   59 -28017.53
11 o$model12[[1]] 155 -24316.48 o$model10[[2]]   94 -11119.43 o$model12[[3]]   52 -27717.41
12 o$model11[[1]] 187 -24259.03  o$model9[[2]]   66 -11108.18  o$model7[[3]]   38 -27339.65
13  o$model1[[1]] 131 -24064.23  o$model1[[2]]   59 -11091.02  o$model3[[3]]   45 -27221.73
14  o$model2[[1]] 132 -24049.02  o$model6[[2]]   73 -11085.12  o$model4[[3]]   52 -27214.79
15  o$model8[[1]] 139 -24045.93  o$model2[[2]]   60 -11074.95  o$model6[[3]]   38 -26849.65
16  o$model9[[1]] 139 -24007.57 o$model11[[2]]  108 -11049.99  o$model8[[3]]   38 -26845.97
17  o$model5[[1]] 163 -23950.60  o$model5[[2]]   73 -11045.37  o$model5[[3]]   38 -26825.20
18  o$model6[[1]] 163 -23862.94 o$model15[[2]]  108 -11030.68  o$model9[[3]]   38 -26695.14
19  o$model4[[1]] 226 -23856.48  o$model3[[2]]   87 -11011.79  o$model1[[3]]   31 -26673.04
20  o$model3[[1]] 195 -23825.07  o$model4[[2]]  101 -10916.61  o$model2[[3]]   32 -26662.86

```{r}
mod[[21]] <- function(df) {
    print(c('mod = 21' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                 #  isYOY * river * season * cBKTStd2 +
                   isYOY * river * season * cBNTStd2 +
                   isYOY * river * season * cBNTStd * cBKTStd +
                   isYOY * river * season * tempStd2 +

                   (1|ind) + (1|season), data = df ) }

mod[[22]] <- function(df) {
    print(c('mod = 22' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                #   isYOY * river * season * cBKTStd2 +
                   isYOY * river * season * cBNTStd2 +
                   isYOY * river * season * cBNTStd * cBKTStd +
                   isYOY * river * season * flowStd2 +
                   (1|ind) + (1|season), data = df ) }

mod[[23]] <- function(df) {
    print(c('mod = 23' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                #   isYOY * river * season * cBKTStd2 +
                   isYOY * river * season * cBNTStd2 +
                   isYOY * river * season * cBNTStd * cBKTStd +
                   isYOY * river * season * tempStd2 +
                   isYOY * river * season * flowStd2 +
                   (1|ind) + (1|season), data = df ) }

```

          rowname  df       AIC      rowname.1 df.1     AIC.1      rowname.2 df.2     AIC.2
1  o$model17[[1]] 272 -24796.58 o$model18[[2]]  122 -11217.98 o$model11[[3]]   80 -29379.29
2  o$model18[[1]] 241 -24795.12 o$model16[[2]]  122 -11211.56 o$model15[[3]]   59 -28755.46
3  o$model16[[1]] 249 -24778.30 o$model17[[2]]  136 -11207.54 o$model22[[3]]   73 -28459.70
4  o$model14[[1]] 218 -24767.67 o$model12[[2]]   80 -11203.21 o$model23[[3]]   80 -28405.91
5  o$model19[[1]] 249 -24730.67 o$model22[[2]]  136 -11193.90 o$model16[[3]]   66 -28318.31
6  o$model20[[1]] 218 -24727.16 o$model20[[2]]  108 -11169.43 o$model17[[3]]   73 -28313.67
7  o$model21[[1]] 272 -24699.83 o$model13[[2]]  108 -11167.05 o$model14[[3]]   59 -28310.73
8  o$model13[[1]] 226 -24689.16  o$model8[[2]]   66 -11166.73 o$model13[[3]]   59 -28306.10
9  o$model10[[1]] 195 -24650.05 o$model21[[2]]  136 -11152.36 o$model19[[3]]   66 -28282.69
10 o$model22[[1]] 272 -24608.90 o$model19[[2]]  122 -11146.57 o$model18[[3]]   66 -28267.13
11 o$model15[[1]] 210 -24589.74 o$model14[[2]]  108 -11140.80 o$model21[[3]]   73 -28244.31
12 o$model23[[1]] 303 -24567.09 o$model23[[2]]  149 -11139.31 o$model10[[3]]   52 -28077.66
13  o$model7[[1]] 139 -24336.63  o$model7[[2]]   66 -11129.29 o$model20[[3]]   59 -28017.53
14 o$model12[[1]] 155 -24316.48 o$model10[[2]]   94 -11119.43 o$model12[[3]]   52 -27717.41
15 o$model11[[1]] 187 -24259.03  o$model9[[2]]   66 -11108.18  o$model7[[3]]   38 -27339.65
16  o$model1[[1]] 131 -24064.23  o$model1[[2]]   59 -11091.02  o$model3[[3]]   45 -27221.73
17  o$model2[[1]] 132 -24049.02  o$model6[[2]]   73 -11085.12  o$model4[[3]]   52 -27214.79
18  o$model8[[1]] 139 -24045.93  o$model2[[2]]   60 -11074.95  o$model6[[3]]   38 -26849.65
19  o$model9[[1]] 139 -24007.57 o$model11[[2]]  108 -11049.99  o$model8[[3]]   38 -26845.97
20  o$model5[[1]] 163 -23950.60  o$model5[[2]]   73 -11045.37  o$model5[[3]]   38 -26825.20
21  o$model6[[1]] 163 -23862.94 o$model15[[2]]  108 -11030.68  o$model9[[3]]   38 -26695.14
22  o$model4[[1]] 226 -23856.48  o$model3[[2]]   87 -11011.79  o$model1[[3]]   31 -26673.04
23  o$model3[[1]] 195 -23825.07  o$model4[[2]]  101 -10916.61  o$model2[[3]]   32 -26662.86

```{r}
# add squared terms back in to good model for ats? NO

mod[[24]] <- function(df) {
    print(c('mod = 24' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cATSStd2 +
                   isYOY * river * season * tempStd2 +

                   (1|ind) + (1|season), data = df ) }

mod[[25]] <- function(df) {
    print(c('mod = 25' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cATSStd2 +

                   isYOY * river * season * flowStd2 +
                   (1|ind) + (1|season), data = df ) }

mod[[26]] <- function(df) {
    print(c('mod = 26' ))
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cATSStd2 +
                   isYOY * river * season * tempStd2 +
                   isYOY * river * season * flowStd2 +
                   (1|ind) + (1|season), data = df ) }
```

          rowname  df       AIC      rowname.1 df.1     AIC.1      rowname.2 df.2     AIC.2
1  o$model17[[1]] 272 -24796.58 o$model18[[2]]  122 -11217.98 o$model11[[3]]   80 -29379.29
2  o$model18[[1]] 241 -24795.12 o$model16[[2]]  122 -11211.56 o$model15[[3]]   59 -28755.46
3  o$model16[[1]] 249 -24778.30 o$model17[[2]]  136 -11207.54 o$model24[[3]]   66 -28732.88
4  o$model14[[1]] 218 -24767.67 o$model12[[2]]   80 -11203.21 o$model26[[3]]   73 -28728.16
5  o$model19[[1]] 249 -24730.67 o$model22[[2]]  136 -11193.90 o$model25[[3]]   66 -28722.50
6  o$model20[[1]] 218 -24727.16 o$model20[[2]]  108 -11169.43 o$model22[[3]]   73 -28459.70
7  o$model21[[1]] 272 -24699.83 o$model13[[2]]  108 -11167.05 o$model23[[3]]   80 -28405.91
8  o$model13[[1]] 226 -24689.16  o$model8[[2]]   66 -11166.73 o$model16[[3]]   66 -28318.31
9  o$model10[[1]] 195 -24650.05 o$model21[[2]]  136 -11152.36 o$model17[[3]]   73 -28313.67
10 o$model22[[1]] 272 -24608.90 o$model19[[2]]  122 -11146.57 o$model14[[3]]   59 -28310.73
11 o$model15[[1]] 210 -24589.74 o$model14[[2]]  108 -11140.80 o$model13[[3]]   59 -28306.10
12 o$model23[[1]] 303 -24567.09 o$model23[[2]]  149 -11139.31 o$model19[[3]]   66 -28282.69
13 o$model25[[1]] 241 -24463.80  o$model7[[2]]   66 -11129.29 o$model18[[3]]   66 -28267.13
14 o$model24[[1]] 241 -24462.46 o$model10[[2]]   94 -11119.43 o$model21[[3]]   73 -28244.31
15 o$model26[[1]] 272 -24413.64  o$model9[[2]]   66 -11108.18 o$model10[[3]]   52 -28077.66
16  o$model7[[1]] 139 -24336.63  o$model1[[2]]   59 -11091.02 o$model20[[3]]   59 -28017.53
17 o$model12[[1]] 155 -24316.48  o$model6[[2]]   73 -11085.12 o$model12[[3]]   52 -27717.41
18 o$model11[[1]] 187 -24259.03  o$model2[[2]]   60 -11074.95  o$model7[[3]]   38 -27339.65
19  o$model1[[1]] 131 -24064.23 o$model11[[2]]  108 -11049.99  o$model3[[3]]   45 -27221.73
20  o$model2[[1]] 132 -24049.02  o$model5[[2]]   73 -11045.37  o$model4[[3]]   52 -27214.79
21  o$model8[[1]] 139 -24045.93 o$model25[[2]]  122 -11045.32  o$model6[[3]]   38 -26849.65
22  o$model9[[1]] 139 -24007.57 o$model15[[2]]  108 -11030.68  o$model8[[3]]   38 -26845.97
23  o$model5[[1]] 163 -23950.60  o$model3[[2]]   87 -11011.79  o$model5[[3]]   38 -26825.20
24  o$model6[[1]] 163 -23862.94 o$model26[[2]]  136 -10980.93  o$model9[[3]]   38 -26695.14
25  o$model4[[1]] 226 -23856.48 o$model24[[2]]  122 -10963.97  o$model1[[3]]   31 -26673.04
26  o$model3[[1]] 195 -23825.07  o$model4[[2]]  101 -10916.61  o$model2[[3]]   32 -26662.86


```{r}


bySpecies <- bySpecies %>%
       mutate( model1 =  map(data, mod[[1]]) ) %>%
       mutate( model2 =  map(data, mod[[2]]) ) %>%
       mutate( model3 =  map(data, mod[[3]]) ) %>%
       mutate( model4 =  map(data, mod[[4]]) ) %>%
       mutate( model5 =  map(data, mod[[5]]) ) %>%
       mutate( model6 =  map(data, mod[[6]]) ) %>%
       mutate( model7 =  map(data, mod[[7]]) ) %>%
       mutate( model8 =  map(data, mod[[8]]) ) %>%
       mutate( model9 =  map(data, mod[[9]]) ) %>%
       mutate( model10 = map(data, mod[[10]]) ) %>%
       mutate( model11 = map(data, mod[[11]]) ) %>%
       mutate( model12 = map(data, mod[[12]]) ) %>%
       mutate( model13 = map(data, mod[[13]]) ) %>%
       mutate( model14 = map(data, mod[[14]]) ) %>%
       mutate( model15 = map(data, mod[[15]]) ) %>%
       mutate( model16 = map(data, mod[[16]]) ) %>%
       mutate( model17 = map(data, mod[[17]]) ) %>%
       mutate( model18 = map(data, mod[[18]]) ) %>%
       mutate( model19 = map(data, mod[[19]]) ) %>%
       mutate( model20 = map(data, mod[[20]]) ) %>%
       mutate( model21 = map(data, mod[[21]]) ) %>%
       mutate( model22 = map(data, mod[[22]]) ) %>%
       mutate( model23 = map(data, mod[[23]]) ) %>%
       mutate( model24 = map(data, mod[[24]]) ) %>%
       mutate( model25 = map(data, mod[[25]]) ) %>%
       mutate( model26 = map(data, mod[[26]]) )
```               
         
> bySpecies$model18[[1]]
Linear mixed model fit by REML ['lmerMod']
Formula: grLength ~ isYOY * river * season * tempStd * flowStd + isYOY *  
    river * season * cBKTStd + isYOY * river * season * cBNTStd +      isYOY * season * cATSStd + isYOY * river * season * cBNTStd2 +  
    isYOY * river * season * cBNTStd * cBKTStd + (1 | ind) +      (1 | season)
   Data: df
REML criterion at convergence: -25277.12
Random effects:
 Groups   Name        Std.Dev.
 ind      (Intercept) 0.02184 
 season   (Intercept) 0.04763 
 Residual             0.06008 
Number of obs: 9967, groups:  ind, 5731; season, 4

> bySpecies$model18[[2]]
Linear mixed model fit by REML ['lmerMod']
Formula: grLength ~ isYOY * river * season * tempStd * flowStd + isYOY *  
    river * season * cBKTStd + isYOY * river * season * cBNTStd +  
    isYOY * season * cATSStd + isYOY * river * season * cBNTStd2 +  
    isYOY * river * season * cBNTStd * cBKTStd + (1 | ind) +      (1 | season)
   Data: df
REML criterion at convergence: -11461.98
Random effects:
 Groups   Name        Std.Dev.
 ind      (Intercept) 0.01955 
 season   (Intercept) 0.08491 
 Residual             0.06018 
Number of obs: 4495, groups:  ind, 2714; season, 4

> bySpecies$model11[[3]]
Linear mixed model fit by REML ['lmerMod']
Formula: grLength ~ isYOY * river * season * tempStd * flowStd + isYOY *  
    season * cBKTStd * cBNTStd * cATSStd + (1 | ind) + (1 | season)
   Data: df
REML criterion at convergence: -29539.29
Random effects:
 Groups   Name        Std.Dev.
 ind      (Intercept) 0.01831 
 season   (Intercept) 0.03268 
 Residual             0.03954 
Number of obs: 8732, groups:  ind, 4183; season, 4
         
```{r}
#2 or 5 fish have lengthByYear = NA whcih gives warning of diff # of observations when include mod with lengthByYear

o <- bySpecies
b <- AIC(o$model1[[1]],
         o$model2[[1]],
           o$model3[[1]],
           o$model4[[1]],
           o$model5[[1]],
           o$model6[[1]],
           o$model7[[1]],
           o$model8[[1]],
           o$model9[[1]],
           o$model10[[1]],
           o$model11[[1]],
           o$model12[[1]],
           o$model13[[1]],
            o$model14[[1]],
            o$model15[[1]],
            o$model16[[1]],
            o$model17[[1]],
            o$model18[[1]],
           o$model19[[1]],
           o$model20[[1]],
           o$model21[[1]],
           o$model22[[1]],
          o$model23[[1]],
           o$model24[[1]],
           o$model25[[1]],
          o$model26[[1]]
         ) %>% rownames_to_column() %>% arrange(AIC) #bkt
n <- AIC(o$model1[[2]],
         o$model2[[2]],
           o$model3[[2]],
           o$model4[[2]],
           o$model5[[2]],
           o$model6[[2]],
           o$model7[[2]],
           o$model8[[2]],
           o$model9[[2]],
           o$model10[[2]],
           o$model11[[2]],
           o$model12[[2]],
           o$model13[[2]],
            o$model14[[2]],
            o$model15[[2]],
            o$model16[[2]],
            o$model17[[2]],
            o$model18[[2]],
           o$model19[[2]],
           o$model20[[2]],
           o$model21[[2]],
           o$model22[[2]],
           o$model23[[2]],
           o$model24[[2]],
           o$model25[[2]],
          o$model26[[2]]
         ) %>% rownames_to_column() %>% arrange(AIC)#bnt
a <- AIC(o$model1[[3]],
         o$model2[[3]],
           o$model3[[3]],
           o$model4[[3]],
           o$model5[[3]],
           o$model6[[3]],
           o$model7[[3]],
           o$model8[[3]],
           o$model9[[3]],
           o$model10[[3]],
           o$model11[[3]],
           o$model12[[3]],
           o$model13[[3]],
            o$model14[[3]],
            o$model15[[3]],
            o$model16[[3]],
            o$model17[[3]],
            o$model18[[3]],
            o$model19[[3]],
           o$model20[[3]],
           o$model21[[3]],
           o$model22[[3]],
          o$model23[[3]],
           o$model24[[3]],
           o$model25[[3]],
           o$model26[[3]]
          ) %>% rownames_to_column() %>% arrange(AIC)#ats

(all <- data.frame(b,n,a))

```

#mod18
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * river * season * cBKTStd +
                   isYOY * river * season * cBNTStd +
                   isYOY *         season * cATSStd +
                   isYOY * river * season * cBKTStd2 +
                   isYOY * river * season * cBNTStd2 +
                   isYOY * river * season * cBNTStd * cBKTStd +
                   (1|ind) + (1|season), data = df ) }

```{r predict}

x <- seq(-1.5,1.5, by = 0.5)

xGrid <- expand.grid( isYOY=unique(d$isYOY), river=unique(d$river), season=unique(d$season), 
                      tempStd=x, flowStd=x, cBKTStd=x, cBNTStd=x, cATSStd=x,
                      ind=1867) %>%
                    mutate(cBKTStd2=cBKTStd^2, cBNTStd2=cBNTStd^2)

p <- predict( bySpecies$model18[[1]], xGrid )
xGridP <- cbind(xGrid,p)

tmp <- 
xGridP %>%
  group_by(isYOY,river,season) %>%
  summarize( meanP = round(mean(p),2) )

 
d %>%
  group_by(isYOY,river,season) %>%
#  summarize( meanP = round(mean(grLength, na.rm=T),2) )
  summarize( meanP = round(mean(flowStd, na.rm=T),2) ) %>%
  data.frame()

varsToPlot='flowStd'
isYOYGG=2
speciesGG='bkt'

#plotPredGrid <- function(xGridP, depVar, varsToPlot, isYOYGG, speciesGG) {
  all = c('tempStd','flowStd','cBKTStd','cBNTStd','cATSStd')

  #print(c(depVar,(as.name(depVar))))

 # if(length(varsToPlot) == 1) {
    notPlot <- NA
    notPlot[1] <- all[!(all %in% varsToPlot)][1]
    notPlot[2] <- all[!(all %in% varsToPlot)][2]
    notPlot[3] <- all[!(all %in% varsToPlot)][3]
    notPlot[4] <- all[!(all %in% varsToPlot)][4]
 #   notPlot[5] <- all[!(all %in% varsToPlot)][5]

 #   pGG <- p %>% filter(isYOY == isYOYGG, species == speciesGG, eval(as.name(notPlot[1])) == 0, eval(as.name(notPlot[2])) == 0, eval(as.name(notPlot[3])) == 0 ) %>%
#                 distinct(eval(as.name(varsToPlot[1])), iter, isYOY, river, species, season, .keep_all = TRUE)
    pGG <- xGridP %>% filter(isYOY == isYOYGG, eval(as.name(notPlot[1])) == 0, eval(as.name(notPlot[2])) == 0, eval(as.name(notPlot[3])) == 0,
                                          eval(as.name(notPlot[4])) == 0
                                        #, eval(as.name(notPlot[5])) == 0
                        ) %>%
      distinct(eval(as.name(varsToPlot[1])), isYOY, river, season, .keep_all = TRUE)

    ggOut <- 
      ggplot( pGG, aes( eval(as.name(varsToPlot[1])), p ) ) +
      geom_line( alpha=0.25 ) +
      theme_bw() +
      theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
      ggtitle(paste0('isYOY = ',isYOYGG,', species = ',speciesGG)) +
      geom_hline(yintercept = 0) +
    #  ylim(-0.25,1.33) +
      scale_x_continuous(varsToPlot[1]) +
      facet_grid(river~season)
ggOut  




```



```{r}

#d[d==-2.5] <- 0


#ftable(d$isYOY,d$species,d$river,d$season,d$year)
tmp1 <- 
 lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                  isYOY * season * cBKTStd * cBNTStd * cATSStd +

   (1|ind) + (1|river), data = bySpecies$data[[1]] )



tmp2 <- 
 lmer( grLength ~ isYOY * river * season * cBKTStd +
                  isYOY * river * season * cBNTStd  +
                  isYOY * season * cATSStd  +
         
       #  
      #            isYOY * river * season * cBNTStd * tempStd * flowStd+
               #   isYOY *         season * cATSStd * tempStd * flowStd +

   (1|ind) , data = bySpecies$data[[1]]) #bySpecies$data[[1]] )

tmp3 <- 
 lmer( grLength ~ isYOY * river * season * cBKTStd +
                  isYOY * river * season * cBNTStd +
                  isYOY * river * season * cATSStd  +
                  isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
         cBKTStd * cBNTStd * cATSStd * tempStd * flowStd +
                   # isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                   # isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                   # isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
          
                  # isYOY * river * season * ( tempStd2 * flowStd2 ) + 
                  # 
                 #  isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                 #  isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                #   isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                  # # isYOY * river * season * ( tempStd2 * flowStd2 * length2 ) + # model error with this line in
                  # isYOY * river * season * ( length2 * countPStdBKT2 ) +
                  # isYOY * river * season * ( length2 * countPStdBNT2 ) +
                  # isYOY * river * season * ( length2 * countPStdATS2 ) + 

   (1|ind), data = bySpecies$data[[1]] )#bySpecies$data[[2]] )

tmp4 <- 
 lmer( grLength ~  isYOY * river * season * tempStd * flowStd  +
                   #isYOY * river * season * tempStd2 * flowStd2  +
                   isYOY * season * cBKTStd * cBNTStd * cATSStd +
                   isYOY * season * cBKTStd2 * cBNTStd2 * cATSStd2 +


   (1|ind) , data = bySpecies$data[[2]] )#bySpecies$data[[2]] )

x <- model.matrix(~ isYOY * river * season * tempStd * flowStd  +
                   #isYOY * river * season * tempStd2 * flowStd2  +
                   isYOY * season * cBKTStd * cBNTStd * cATSStd +
                   isYOY * season * cBKTStd2 * cBNTStd2 * cATSStd2 +
   (1|ind) , data = bySpecies$data[[2]])


xx <- findLinearCombos((x))
getBadCols <- function(col){
  cols <- xx$linearCombos[[col]]
  badCols1 <- x[,cols]
  badCols <- dimnames(badCols1)[[2]]
  return(badCols)
}

getBadCols(41)

# removed dimnames
dimnames(x)[[2]][xx$remove]

d %>% filter(species==1, river==4) %>% select(cATSStd) %>% distinct()



AIC(tmp1,tmp2,tmp3) %>% rownames_to_column() %>% arrange(AIC)

ggplot(d%>%filter(species==2), aes(lengthByYear,grLength, color=isYOY)) + geom_point() + geom_smooth(method='lm') + facet_grid(isYOY+river~season)
ggplot(d%>%filter(species==2), aes(flowStd,grLength, color=isYOY)) + geom_point() + geom_smooth(method='lm') + facet_grid(isYOY~season)

ggplot(d%>%filter(species==2), aes(lengthByYear,countPStdATS, color=isYOY)) + geom_point() + geom_smooth(method='lm') + facet_grid(isYOY~season)

d%>%filter(species==2 & season==2 &isYOY==1)

d$countPStdATS <- ifelse(d$species %in% c('2') & d$isYOY == 1 & d$season == "2", NA, d$countPStdATS)
d$countPStdATS <- ifelse( d$river %in% c("3","4"), NA, d$countPStdATS)

d$cBNTStd <- ifelse(d$river %in% c('4') , NA, d$cBNTStd)
d$countPStdATS <- ifelse( d$river %in% c("3","4"), NA, d$countPStdATS)
```

```{r}


mod[[1]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * season * cBKTStd * cBNTStd * cATSStd +

                   (1|ind), data = df ) }

mod[[2]] <- function(df) {
 lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                  isYOY * river * season * cBKTStd +
                  isYOY * river * season * cBNTStd +
                  isYOY * river * season * cBNTStd +

                  (1|ind), data = df ) }

mod[[3]] <- function(df) {
  lmer( grLength ~ isYOY * river * season * tempStd * flowStd  +
                   isYOY * season * cBKTStd * cBNTStd +

                   (1|ind), data = df ) } 

#mod[[4]] <- function(df) {
#  lmer( grLength ~ isYOY * river * season * cBKTStd * cBKTStd * cBKTStd +

#                   (1|ind), data = df ) }


mod[[5]] <- function(df) { lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                         isYOY * river * season * ( tempStd2 * flowStd2 ) +
                         isYOY * river * season * ( countPStdBNT2_01 ) +
                         # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }

mod[[6]] <- function(df) { lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                         # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }

mod[[7]] <- function(df) { lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }

mod[[8]] <- function(df) { lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                         isYOY * river * season * ( tempStd2 * flowStd2  ) +
                         isYOY * river * season * ( tempStd2 * flowStd2  ) +
                         isYOY * river * season * ( tempStd2 * flowStd2  ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }


mod[[9]] <- function(df) { lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }

mod[[10]] <- function(df) {  lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                        # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                        # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }

mod[[11]] <- function(df) {  lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                       #  isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                       #   isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }

mod[[12]] <- function(df) {  lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                        # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                       #  isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }

mod[[13]] <- function(df) {  lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                        # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }

mod[[14]] <- function(df) {  lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                        # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }

mod[[15]] <- function(df) {  lmer( grLength ~ isYOY * river * season * ( tempStd * flowStd * countPStdBKT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdBNT_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * countPStdATS_01 ) +
                         isYOY * river * season * ( tempStd * flowStd * lengthByYear ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBKT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdBNT_01 ) +
                         # isYOY * river * season * ( lengthByYear * countPStdATS_01 ) +                
                
                        # isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBKT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdBNT2_01 ) +
                         isYOY * river * season * ( tempStd2 * flowStd2 * countPStdATS2_01 ) +
                         # # isYOY * river * season * ( tempStd2 * flowStd2 * lengthByYear2 ) + # model error with this line in
                         # isYOY * river * season * ( lengthByYear2 * countPStdBKT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdBNT2_01 ) +
                         # isYOY * river * season * ( lengthByYear2 * countPStdATS2_01 ) + 

                         (1|ind), data = df ) }
 
  
```
